%
% Note that the order that the packages are imported sometimes it
% matters. That is, some packages should be imported before others.
% Otherwise, it may not work correctly.
%
% You may have to add new packages, remove packages, or modify their
% input arguments to obtain the intended functionality.
%

% Input encoding. LuaTeX uses UTF-8 encoding by default.
% \usepackage[utf8]{inputenc}

% Font encoding.
\usepackage[T1]{fontenc}
\usepackage{textcomp}

% Using "Latin Modern" font is better.
% https://tex.stackexchange.com/questions/88368/how-do-i-invoke-cm-super
% http://tug.org/pipermail/macostex-archives/2004-July/006964.html
% https://tex.stackexchange.com/questions/30814/identity-of-latex-default-sans-serif-font/30816
% https://tex.stackexchange.com/questions/66674/when-i-load-multiple-font-packages-which-one-will-win
% https://tex.stackexchange.com/questions/25249/how-do-i-use-a-particular-font-for-a-small-section-of-text-in-my-document
\usepackage{lmodern}

% Select the language (here and in "after-begin.tex").
\usepackage[USenglish]{babel}
% \usepackage[UKenglish]{babel}
% \usepackage[portuguese]{babel}

% The "csquotes" package should be used with the "babel" package.
% https://tex.stackexchange.com/questions/229638/package-biblatex-warning-babel-polyglossia-detected-but-csquotes-missing
\usepackage[style=USenglish,threshold=1]{csquotes}
% \usepackage[style=UKenglish,threshold=1]{csquotes}
% \usepackage[style=portuguese,threshold=1]{csquotes}

% Removing vertical space before block quotes.
% https://tex.stackexchange.com/questions/53287/leading-vertical-space-before-and-after-block-quotes
\usepackage[vskip=0pt]{quoting}
\SetBlockEnvironment{quoting}

\usepackage[%
a4paper,%
% These margins are accordingly to the UA rules.
% http://www.ua.pt/sga/PageText.aspx?id=4630
% left=30mm,%
% right=25mm,%
% bottom=30mm,%
% top=30mm,%
% However, one can slightly modify the margins, so there is no shift
% when changing pages in a PDF document viewer.
% https://en.wikibooks.org/wiki/Basic_Book_Design/Margins
left=30mm,%
right=30mm,%
bottom=30mm,%
top=30mm,%
% To show visible frames for the text area and page.
% showframe,%
]{geometry}

% Mathematical utilities.
\usepackage{amsmath}
\usepackage{amssymb}

% Linux libertine font type.
% https://ctan.org/pkg/libertine
% \usepackage{libertine}
% \renewcommand{\ttdefault}{lmtt}
% \usepackage[libertine]{newtxmath}

% Font selection in LuaTeX.
% https://ctan.org/pkg/fontspec
% Libertinus font.
% https://github.com/alerque/libertinus
% https://en.wikipedia.org/wiki/Linux_Libertine
\usepackage{fontspec}

\setmainfont{Libertinus Serif}
% \setmainfont{Linux Libertine O}

% Use Helvetica font type for the first pages.
% https://tex.stackexchange.com/questions/25249/how-do-i-use-a-particular-font-for-a-small-section-of-text-in-my-document/37251
% \setsansfont{Arial}
% \setsansfont{Arimo}
% \setsansfont{Helvetica}
\setsansfont{Libertinus Sans}
% \setsansfont{Linux Biolinum O}
% \setsansfont{TeX Gyre Heros}

% \setmonofont{Courier New}
% \setmonofont{Courier Prime}[Scale=MatchLowercase]
% \setmonofont{CMU Typewriter Text}
% \setmonofont{Inconsolata}
% \setmonofont{Inconsolata}[Scale=0.9]
\setmonofont{Inconsolata}[Scale=MatchLowercase]
% \setmonofont{Inconsolata}[Scale=MatchUppercase]
% \setmonofont{JetBrains Mono}
% \setmonofont{Latin Modern Mono}
% \setmonofont{Libertinus Mono}
% \setmonofont{Lucida Console}
% \setmonofont{Menlo}
% \setmonofont{Monaco}
% \setmonofont{Ubuntu Mono}
% \setmonofont{Roboto Mono}
% \setmonofont{Source Code Pro}
% \setmonofont{Space Mono}

% To use \mathbf{} without errors.
% https://github.com/wspr/unicode-math/issues/556
\usepackage{unicode-math}
\setmathfont{Libertinus Math}

% Line spacing. The "setspace" package has to be loaded before the
% "hyperref" package to ensure that the links of footnotes are correct.
% https://tex.stackexchange.com/questions/203439/footnotes-misbehaving-in-report-go-to-front-page-but-behave-correctly-in-other-r
\usepackage{setspace}

\usepackage{needspace}

\usepackage[font=onehalfspacing]{caption}

% To use more colors.
\usepackage[x11names,table]{xcolor}

% To rotate pages.
% \usepackage{pdflscape}

% Managing URLs.
\usepackage[hyphens,spaces]{xurl}

% To modify the URL style (sans serif).
% https://tex.stackexchange.com/questions/79051/how-to-style-text-in-hyperref-url
% \urlstyle{sf}

% To use Helvetica font.
% https://pt.overleaf.com/learn/latex/Font_typefaces
% \def\UrlFont{\fontfamily{phv}\selectfont}

% For long comments.
% \usepackage{comment}

% BibLaTeX bibliography. Select the preferred citation style.
% Alternatively, you can configure your own.
% From the "biblatex" documentation: "When using the hyperref package,
% it is preferable to load it after biblatex."
% \input{tex/config/biblatex/authoryear.tex}
\input{tex/config/biblatex/authoryear-comp.tex}
% \input{tex/config/biblatex/numeric.tex}

% Input ".bib" file name with the references.
\bibliography{refs.bib}

% To remove repeated hyperlink from arXiv.
% https://tex.stackexchange.com/questions/332537/biblatex-inserts-dead-link-when-citing-an-eprint
\DeclareFieldFormat{eprint:arxiv}{{arXiv:#1}}

% To break URLs.
% https://stackoverflow.com/questions/2625714/linebreak-in-url-with-bibtex-and-hyperref-package
% https://tex.stackexchange.com/questions/22854/url-line-breaks-with-biblatex
% \setcounter{biburlnumpenalty}{3000}
% \setcounter{biburlucpenalty}{6000}
% \setcounter{biburllcpenalty}{9000}

% These values are recommended in the "xurl" package.
\setcounter{biburllcpenalty}{100}
\setcounter{biburlucpenalty}{200}
\setcounter{biburlnumpenalty}{100}

% Add a line break before the URL.
% https://tex.stackexchange.com/questions/27953/linebreak-before-url-with-biblatex-alphabetic
\DeclareFieldFormat{formaturl}{\newline #1}
\renewbibmacro*{url+urldate}{%
  \printtext[formaturl]{%
    \printfield{url}}%
  \iffieldundef{urlyear}
    {}
    {\setunit*{\addspace}%
     \printtext[urldate]{\printurldate}}}

% Changing master's thesis text.
% https://tex.stackexchange.com/questions/226989/biblatex-changing-key-mastersthesis-to-mphilthesis
\DefineBibliographyStrings{portuguese}{%
  mathesis = {Dissertação de mestrado},
}
\DefineBibliographyStrings{english}{%
  % mathesis = {MSc thesis},
  mathesis = {Master's thesis},
}

% To modify the text of back referencing (citations).
% https://tex.stackexchange.com/questions/113264/biblatex-move-backrefpages-to-after-the-period
% \DefineBibliographyStrings{english}{%
%     % backrefpage  = {See p.},
%     % backrefpages = {See pp.},
%     % backrefpage  = {Cited on page},
%     % backrefpages = {Cited on pages},
%     backrefpage  = {Cit. on p.},
%     backrefpages = {Cit. on pp.},
% }

% Put back reference citation after the period.
% https://tex.stackexchange.com/questions/113264/biblatex-move-backrefpages-to-after-the-period
% \renewbibmacro*{finentry}{\iflistundef{pageref}{}{\renewcommand{\finentrypunct}{}}\finentry}
% \renewbibmacro*{pageref}{%
%   \iflistundef{pageref}
%     {}
%     {
%       \setunit{\adddot\addspace}\printtext{%
%         % \fbox{
%             \newline
%             \ifnumgreater{\value{pageref}}{1}
%               {(\bibstring{backrefpages}\ppspace}
%               {(\bibstring{backrefpage}\ppspace}%
%               \printlist[pageref][-\value{listtotal}]{pageref})
%         % }
%       }
%     }
% }

% References (citations, images, tables, among others).
% Links cannot break between pages (it is mandatory to manually
% rearrange the text).
% https://tex.stackexchange.com/questions/1522/pdfendlink-ended-up-in-different-nesting-level-than-pdfstartlink
\usepackage[%
breaklinks,%
% draft,%
hidelinks,%
colorlinks,%
% linktoc=all,%
linktoc=page,%
% For the final printed version.
allcolors=black,%
% citecolor=black,%
% citecolor=black!50,%
% citecolor=black!55,%
citecolor=black!60,%
% citecolor=Blue3,%
% linkcolor=black,%
% linkcolor=black!50,%
% linkcolor=black!55,%
linkcolor=black!60,%
% linkcolor=Blue3,%
% urlcolor=black,%
% urlcolor=black!50,%
% urlcolor=black!55,%
urlcolor=black!60,%
% urlcolor=Azure4,%
% urlcolor=Blue3,%
% urlcolor=Ivory4,%
% urlcolor=Red2,%
% urlcolor=Snow4,%
]{hyperref}

% To change the link colors of only figures or tables.
% https://latex.org/forum/viewtopic.php?t=3458

% To make the hyperlink put the cursor at the beginning of the figure
% (that is, not in the figure caption).
\usepackage[all]{hypcap}

% The "cleveref" package has to be loaded after the "hyperref" package.
% The "cleveref" has to be loaded after the "amsmath" package to
% correctly reference equations.
% https://tex.stackexchange.com/questions/148699/equation-reference-undefined-when-using-cref-and-packageamsmath
\usepackage[%
nameinlink,%
noabbrev,%
]{cleveref}

% Multiple references to the same footnote.
% https://tex.stackexchange.com/questions/10102/multiple-references-to-the-same-footnote-with-hyperref-support-is-there-a-bett
\crefformat{footnote}{#2\footnotemark[#1]#3}

% To create hyperlinks from the footnotes at the bottom of the page,
% back to the occurrence of the footnote in the main text.
% This package conflicts with the "\footcitetext" command from the
% "biblatex" package.
\usepackage{footnotebackref}

% Table footnote.
% https://tex.stackexchange.com/questions/1583/footnotes-in-tables
% From "tablefootnote" documentation (page 20):
% When the document is compiled with LuaLaTeX, hyperlinks in rotated
% content will be misplaced. Use it with caution.
% \usepackage{tablefootnote}

% Header and footer treatment.
\usepackage{fancyhdr}

% To place floats (figures, tables) at fixed position using the
% "\FloatBarrier" command.
% \usepackage{placeins}

% To allow tables spanning multiple pages.
% https://texfaq.org/FAQ-longtab
% To prevent longtable breaking in multirow.
% https://tex.stackexchange.com/questions/64956/prevent-longtable-breaking-in-multirow
% A longtable example.
% http://users.sdsc.edu/~ssmallen/latex/longtable.html
\usepackage{longtable}

% To enhance the quality of tables.
\usepackage{booktabs}

% To specify vertical alignment in rows (tables).
\usepackage{array}

% Horizontally centered and right aligned.
% https://tex.stackexchange.com/questions/154958/vertically-centered-and-right-left-center-horizontal-alignment-in-tabular

% Note: the following shortcuts for column alignments are easy to
% memorize. They form a 3x3 square in the QWERTY keyboard layout.

% --- Top (vertical alignment) ---
% Justified.
% p{...}
% Left-aligned.
\newcolumntype{E}[1]{>{\raggedright\arraybackslash}p{#1}}
% Centered.
\newcolumntype{R}[1]{>{\centering\arraybackslash}p{#1}}
% Right-aligned.
\newcolumntype{T}[1]{>{\raggedleft\arraybackslash}p{#1}}

% --- Middle (vertical alignment) ---
% Justified.
% m{...}
% Left-aligned.
\newcolumntype{D}[1]{>{\raggedright\arraybackslash}m{#1}}
% Centered.
\newcolumntype{F}[1]{>{\centering\arraybackslash}m{#1}}
% Right-aligned.
\newcolumntype{G}[1]{>{\raggedleft\arraybackslash}m{#1}}

% --- Bottom (vertical alignment) ---
% Justified.
% b{...}
% Left-aligned.
\newcolumntype{C}[1]{>{\raggedright\arraybackslash}b{#1}}
% Centered.
\newcolumntype{V}[1]{>{\centering\arraybackslash}b{#1}}
% Right-aligned.
\newcolumntype{B}[1]{>{\raggedleft\arraybackslash}b{#1}}

% Extra column with zero width and no padding. This is used to avoid the
% incorrect alignment in the last column.
% https://tex.stackexchange.com/questions/159257/increase-latex-table-row-height
% https://tex.stackexchange.com/questions/68732/vertical-alignment-in-table-m-column-row-size-problem-in-last-column
\newcolumntype{N}{@{}m{0pt}@{}}

% Empty column separator.
% https://texfaq.org/FAQ-fixwidtab
\newcolumntype{O}{@{}}

% To use 2% of the \textwidth as column separator.
\newcolumntype{I}{@{\hskip0.02\textwidth}}

% Multirow in tables.
\usepackage{multirow}

% New lines in multirow cells.
% https://tex.stackexchange.com/questions/331716/newline-in-multirow-environment
% \usepackage{makecell}

% To change the itemize character.
\usepackage{enumitem}

% To compact the "itemize" list.
% https://stackoverflow.com/questions/4968557/latex-very-compact-itemize/4974583#4974583
\setlist{itemsep=5pt,topsep=5pt,parsep=5pt,partopsep=5pt}

% To place "longtable" tables at the top of the page.
\usepackage{afterpage}

% Hyphenation throughout the document.
\usepackage{hyphenat}
% To disable hyphenation use the "none" option.
% \usepackage[none]{hyphenat}

% For rotating text with the "turn" command.
% \usepackage{rotating}

% To use the "\sfrac" command.
% \usepackage{xfrac}

% Disable displaying page number, header and footer on empty pages.
\usepackage{emptypage}

% Colored boxes.
% \usepackage[most]{tcolorbox}

% To force not to break the line after a hyphen. This conflicts with
% latexdiff.
% https://tex.stackexchange.com/questions/103608/how-to-force-latex-not-to-break-the-line-after-a-hyphen
% \usepackage[shortcuts]{extdash}

% From the "glossaries" package documentation:
% "If you want to change the font for the description, or if you only
% want to change the name font for some types of entries but not others,
% you might want to consider using the glossaries-extra package."

% For creating a list of abbreviations.
\usepackage[%
nogroupskip=false,%
nonumberlist=true,%
nopostdot=true,%
% style=alttree,%
style=listdotted,%
% style=long,%
% style=super,%
shortcuts=abbreviations,%
% The "uathesis" style file is already adding the glossary into the
% table of contents.
toc=false,%
]{glossaries-extra}

% To revert \markright, \markboth and \@starttoc related with the
% \MakeUpperCase command. This is required to not mix up with the
% uppercase of chapter headings.
\glsxtrRevertMarks

% To disable all abbreviation hyperlinks.
% https://tex.stackexchange.com/questions/25805/disable-hyperlinks-in-some-entries-for-glossaries
\glsdisablehyper

% To uppercase terms (in abreviations) after a hyphen.
% https://tex.stackexchange.com/questions/402692/hyphen-in-uppercase-acronyms-in-glossaries
% \MFUhyphentrue

% To generate the glossary.
% https://tex.stackexchange.com/questions/243750/acronym-glossary-doesnt-appear
\makenoidxglossaries

% From the "glossaries" package documentation:
% "Otherwise you end up with nested links, which can cause complications
% and they won't work with the case-changing commands."

% From the "glossaries-extra" package documentation:
% "Complications arise when you use \gls in the value of
% the name field".

% From the "glossaries-extra" package documentation:
% "If you really need nested commands, the safest method is
%   \newabbreviation
%   {shtml}
%   {shtml}
%   {{}\glsxtrp{short}{ssi} enabled \glsxtrp{short}{html}}
% but be aware that it may have some unexpected results occasionally."

% However, it is necessary to use "\glsadd{}" so the abbreviation
% appears in the glossary.
% A simplified example:
%   \newabbreviation
%   {hgnc}
%   {HGNC}
%   {{}\glsps{hugo}\glsadd{hugo} Gene Nomenclature Committee}
% https://latex.org/forum/viewtopic.php?t=2976

% To set the description in title case, or only the first letter
% uppercase, in the glossary.
% \glssetcategoryattribute{abbreviation}{glossdesc}{title}
% \glssetcategoryattribute{abbreviation}{glossdesc}{firstuc}

% To convert the abbreviations to all capitals, or only the first
% letter, in the glossary.
% \glssetcategoryattribute{abbreviation}{glossname}{uc}
% \glssetcategoryattribute{abbreviation}{glossname}{firstuc}

% To not break a line before an abbreviation use a "~" before the
% opening parenthesis. Example:
%   Information extraction~(\glsxtrshort{ie}) aims to...
% https://tex.stackexchange.com/questions/355165/avoid-line-break-before-acronym
% https://latex.org/forum/viewtopic.php?t=4179

% To add links inside captions.
% https://tex.stackexchange.com/questions/30800/gls-inside-caption-without-protect
\robustify{\gls}

% To specify the widest name of the short form of an abbreviation.
% This applies when the "alttree" style is used.
\glssetwidest{123456789012345}

% To specify dotted distance between abbreviation and description.
% This applies when the "listdotted" style is used.
% https://tex.stackexchange.com/questions/17956/dotted-distance-between-acronym-and-description-in-acronymlist-from-glossaries
\setlength{\glslistdottedwidth}{.28\textwidth}

% To remove bold of the short forms in the glossary.
\renewcommand{\glsnamefont}[1]{\normalfont #1}

% The list of abbreviations is in another file for better organization.
